# Генератор документов v3.0

Настольное приложение для автоматизированного создания документов на основе шаблонов Microsoft Word и данных из Microsoft Excel.

## Возможности

- Массовая генерация документов из Excel и Word шаблонов
- Система плейсхолдеров с автоматической подстановкой данных
- Автоматическое склонение слов по падежам русского языка
- Объединение Word и PDF документов
- Конвертация Word в PDF
- Конвертация изображений в PDF
- OCR для PDF-сканов (распознавание текста)
- Многопоточная обработка с настраиваемым количеством процессов
- Работа с несколькими задачами через систему вкладок
- Сохранение и загрузка пресетов настроек

## Требования

### Для использования скомпилированного приложения
- Windows 10 или новее
- Microsoft Word (для конвертации документов в PDF)

Скомпилированное приложение содержит все необходимые зависимости и не требует установки Python или дополнительных библиотек.

### Для запуска из исходного кода
- Python 3.8+
- Windows 10 или новее
- Microsoft Word (для конвертации документов в PDF)

## Установка зависимостей

```bash
pip install pandas openpyxl python-docx pymorphy3 customtkinter pypdf
pip install pymupdf winsdk reportlab Pillow
pip install pywin32 docx2pdf
```

## Запуск

```bash
python generation_doc.py
```

## Компиляция

Для создания автономного исполняемого файла используйте PyInstaller:

```bash
pip install pyinstaller
pyinstaller --onefile --windowed --name "Генератор_документов" generation_doc.py
```

При компиляции все зависимости включаются в исполняемый файл. Пользователям не нужно устанавливать Python или библиотеки.

## Использование

### Генерация документов

1. Выберите Excel файл с данными
2. Выберите шаблон Word документа с плейсхолдерами
3. Укажите папку для сохранения
4. Настройте параметры именования файлов
5. Нажмите "Начать обработку"

### Плейсхолдеры

В шаблоне Word используйте фигурные скобки:

```
{{фио}}
{{дата}}
{{должность}}
```

Поддерживаемые типы источников данных:
- Столбцы Excel
- Выпадающие списки
- Дата
- Статические значения

### Объединение документов

1. Откройте окно объединения документов
2. Выберите тип операции:
   - Объединение Word документов
   - Объединение PDF документов
   - Конвертация Word в PDF
   - Конвертация изображений в PDF
3. Добавьте файлы и настройте порядок
4. Выполните операцию

## OCR для PDF

Приложение автоматически распознает текст в PDF-сканах при объединении. Для определения необходимости OCR используется порог: если на странице менее 200 символов извлекаемого текста, документ обрабатывается через Windows OCR.

Требования для OCR:
- Windows 10 или новее
- Библиотеки: pymupdf, winsdk, reportlab, Pillow

## Поддерживаемые падежи

| Код | Падеж | Вопрос |
|-----|-------|--------|
| nomn | Именительный | Кто? Что? |
| gent | Родительный | Кого? Чего? |
| datv | Дательный | Кому? Чему? |
| accs | Винительный | Кого? Что? |
| ablt | Творительный | Кем? Чем? |
| loct | Предложный | О ком? О чем? |

## Настройка производительности

Количество параллельных процессов настраивается в зависимости от числа ядер процессора. Рекомендуется использовать количество ядер минус один для стабильной работы системы.

## Пресеты

Настройки можно сохранять в пресеты для быстрого переключения между задачами. Пресеты хранятся в папке `presets`.

## Автор

Канатов М.Э. (Kebury), 2026
